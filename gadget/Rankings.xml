<Module>
<ModulePrefs title="Rankings Page" title_url="http://sites.google.com/" description="Rankings at various times" height="800" width="600" author="AJ Reinhard">
<Require feature="dynamic-height"/>
</ModulePrefs>
<Content type="html" view="default,canvas">
<![CDATA[
<html>
  <head>
	<meta name="twitter:card" content="summary"></meta>
    <base target="_blank">
  </head>
  <body>
  <div id="img-div">
    	<div id="region"></div>
        <div id="county">
          <a class="adams"href="javascript:{}"  target="_top" onclick="MyFilter('Adams',16)"></a>
          <a class="allen"href="javascript:{}"  target="_top" onclick="MyFilter('Allen',16)"></a>
          <a class="ashland"href="javascript:{}"  target="_top" onclick="MyFilter('Ashland',16)"></a>
          <a class="ashtabula"href="javascript:{}"  target="_top" onclick="MyFilter('Ashtabula',16)"></a>
          <a class="athens"href="javascript:{}"  target="_top" onclick="MyFilter('Athens',16)"></a>
          <a class="auglaize"href="javascript:{}"  target="_top" onclick="MyFilter('Auglaize',16)"></a>
          <a class="belmont"href="javascript:{}"  target="_top" onclick="MyFilter('Belmont',16)"></a>
          <a class="brown"href="javascript:{}"  target="_top" onclick="MyFilter('Brown',16)"></a>
          <a class="butler"href="javascript:{}"  target="_top" onclick="MyFilter('Butler',16)"></a>
          <a class="carroll"href="javascript:{}"  target="_top" onclick="MyFilter('Carroll',16)"></a>
          <a class="champaign"href="javascript:{}"  target="_top" onclick="MyFilter('Champaign',16)"></a>
          <a class="clark"href="javascript:{}"  target="_top" onclick="MyFilter('Clark',16)"></a>
          <a class="clermont"href="javascript:{}"  target="_top" onclick="MyFilter('Clermont',16)"></a>
          <a class="clinton"href="javascript:{}"  target="_top" onclick="MyFilter('Clinton',16)"></a>
          <a class="columbiana"href="javascript:{}"  target="_top" onclick="MyFilter('Columbiana',16)"></a>
          <a class="coshocton"href="javascript:{}"  target="_top" onclick="MyFilter('Coshocton',16)"></a>
          <a class="crawford"href="javascript:{}"  target="_top" onclick="MyFilter('Crawford',16)"></a>
          <a class="cuyahoga"href="javascript:{}"  target="_top" onclick="MyFilter('Cuyahoga',16)"></a>
          <a class="darke"href="javascript:{}"  target="_top" onclick="MyFilter('Darke',16)"></a>
          <a class="defiance"href="javascript:{}"  target="_top" onclick="MyFilter('Defiance',16)"></a>
          <a class="delaware"href="javascript:{}"  target="_top" onclick="MyFilter('Delaware',16)"></a>
          <a class="erie"href="javascript:{}"  target="_top" onclick="MyFilter('Erie',16)"></a>
          <a class="fairfield"href="javascript:{}"  target="_top" onclick="MyFilter('Fairfield',16)"></a>
          <a class="fayette"href="javascript:{}"  target="_top" onclick="MyFilter('Fayette',16)"></a>
          <a class="franklin"href="javascript:{}"  target="_top" onclick="MyFilter('Franklin',16)"></a>
          <a class="fulton"href="javascript:{}"  target="_top" onclick="MyFilter('Fulton',16)"></a>
          <a class="gallia"href="javascript:{}"  target="_top" onclick="MyFilter('Gallia',16)"></a>
          <a class="geauga"href="javascript:{}"  target="_top" onclick="MyFilter('Geauga',16)"></a>
          <a class="greene"href="javascript:{}"  target="_top" onclick="MyFilter('Greene',16)"></a>
          <a class="guernsey"href="javascript:{}"  target="_top" onclick="MyFilter('Guernsey',16)"></a>
          <a class="hamilton"href="javascript:{}"  target="_top" onclick="MyFilter('Hamilton',16)"></a>
          <a class="hancock"href="javascript:{}"  target="_top" onclick="MyFilter('Hancock',16)"></a>
          <a class="hardin"href="javascript:{}"  target="_top" onclick="MyFilter('Hardin',16)"></a>
          <a class="harrison"href="javascript:{}"  target="_top" onclick="MyFilter('Harrison',16)"></a>
          <a class="henry"href="javascript:{}"  target="_top" onclick="MyFilter('Henry',16)"></a>
          <a class="highland"href="javascript:{}"  target="_top" onclick="MyFilter('Highland',16)"></a>
          <a class="hocking"href="javascript:{}"  target="_top" onclick="MyFilter('Hocking',16)"></a>
          <a class="holmes"href="javascript:{}"  target="_top" onclick="MyFilter('Holmes',16)"></a>
          <a class="huron"href="javascript:{}"  target="_top" onclick="MyFilter('Huron',16)"></a>
          <a class="jackson"href="javascript:{}"  target="_top" onclick="MyFilter('Jackson',16)"></a>
          <a class="jefferson"href="javascript:{}"  target="_top" onclick="MyFilter('Jefferson',16)"></a>
          <a class="knox"href="javascript:{}"  target="_top" onclick="MyFilter('Knox',16)"></a>
          <a class="lake"href="javascript:{}"  target="_top" onclick="MyFilter('Lake',16)"></a>
          <a class="lawrence"href="javascript:{}"  target="_top" onclick="MyFilter('Lawrence',16)"></a>
          <a class="licking"href="javascript:{}"  target="_top" onclick="MyFilter('Licking',16)"></a>
          <a class="logan"href="javascript:{}"  target="_top" onclick="MyFilter('Logan',16)"></a>
          <a class="lorain"href="javascript:{}"  target="_top" onclick="MyFilter('Lorain',16)"></a>
          <a class="lucas"href="javascript:{}"  target="_top" onclick="MyFilter('Lucas',16)"></a>
          <a class="madison"href="javascript:{}"  target="_top" onclick="MyFilter('Madison',16)"></a>
          <a class="mahoning"href="javascript:{}"  target="_top" onclick="MyFilter('Mahoning',16)"></a>
          <a class="marion"href="javascript:{}"  target="_top" onclick="MyFilter('Marion',16)"></a>
          <a class="medina"href="javascript:{}"  target="_top" onclick="MyFilter('Medina',16)"></a>
          <a class="meigs"href="javascript:{}"  target="_top" onclick="MyFilter('Meigs',16)"></a>
          <a class="mercer"href="javascript:{}"  target="_top" onclick="MyFilter('Mercer',16)"></a>
          <a class="miami"href="javascript:{}"  target="_top" onclick="MyFilter('Miami',16)"></a>
          <a class="monroe"href="javascript:{}"  target="_top" onclick="MyFilter('Monroe',16)"></a>
          <a class="montgomery"href="javascript:{}"  target="_top" onclick="MyFilter('Montgomery',16)"></a>
          <a class="morgan"href="javascript:{}"  target="_top" onclick="MyFilter('Morgan',16)"></a>
          <a class="morrow"href="javascript:{}"  target="_top" onclick="MyFilter('Morrow',16)"></a>
          <a class="muskingum"href="javascript:{}"  target="_top" onclick="MyFilter('Muskingum',16)"></a>
          <a class="noble"href="javascript:{}"  target="_top" onclick="MyFilter('Noble',16)"></a>
          <a class="ottawa"href="javascript:{}"  target="_top" onclick="MyFilter('Ottawa',16)"></a>
          <a class="paulding"href="javascript:{}"  target="_top" onclick="MyFilter('Paulding',16)"></a>
          <a class="perry"href="javascript:{}"  target="_top" onclick="MyFilter('Perry',16)"></a>
          <a class="pickaway"href="javascript:{}"  target="_top" onclick="MyFilter('Pickaway',16)"></a>
          <a class="pike"href="javascript:{}"  target="_top" onclick="MyFilter('Pike',16)"></a>
          <a class="portage"href="javascript:{}"  target="_top" onclick="MyFilter('Portage',16)"></a>
          <a class="preble"href="javascript:{}"  target="_top" onclick="MyFilter('Preble',16)"></a>
          <a class="putnam"href="javascript:{}"  target="_top" onclick="MyFilter('Putnam',16)"></a>
          <a class="richland"href="javascript:{}"  target="_top" onclick="MyFilter('Richland',16)"></a>
          <a class="ross"href="javascript:{}"  target="_top" onclick="MyFilter('Ross',16)"></a>
          <a class="sandusky"href="javascript:{}"  target="_top" onclick="MyFilter('Sandusky',16)"></a>
          <a class="scioto"href="javascript:{}"  target="_top" onclick="MyFilter('Scioto',16)"></a>
          <a class="seneca"href="javascript:{}"  target="_top" onclick="MyFilter('Seneca',16)"></a>
          <a class="shelby"href="javascript:{}"  target="_top" onclick="MyFilter('Shelby',16)"></a>
          <a class="stark"href="javascript:{}"  target="_top" onclick="MyFilter('Stark',16)"></a>
          <a class="summit"href="javascript:{}"  target="_top" onclick="MyFilter('Summit',16)"></a>
          <a class="trumbull"href="javascript:{}"  target="_top" onclick="MyFilter('Trumbull',16)"></a>
          <a class="tuscarawas"href="javascript:{}"  target="_top" onclick="MyFilter('Tuscarawas',16)"></a>
          <a class="union"href="javascript:{}"  target="_top" onclick="MyFilter('Union',16)"></a>
          <a class="van-wert"href="javascript:{}"  target="_top" onclick="MyFilter('Van Wert',16)"></a>
          <a class="vinton"href="javascript:{}"  target="_top" onclick="MyFilter('Vinton',16)"></a>
          <a class="warren"href="javascript:{}"  target="_top" onclick="MyFilter('Warren',16)"></a>
          <a class="washington"href="javascript:{}"  target="_top" onclick="MyFilter('Washington',16)"></a>
          <a class="wayne"href="javascript:{}"  target="_top" onclick="MyFilter('Wayne',16)"></a>
          <a class="williams"href="javascript:{}"  target="_top" onclick="MyFilter('Williams',16)"></a>
          <a class="wood"href="javascript:{}"  target="_top" onclick="MyFilter('Wood',16)"></a>
          <a class="wyandot"href="javascript:{}"  target="_top" onclick="MyFilter('wyandot',16)"></a>      
     </div>
  </div>
  <br>
  <div>
    <button onclick="MyFilter('1',3); change_map(1)">Div I</button>
    <button onclick="MyFilter('2',3); change_map(2)">Div II</button>
    <button onclick="MyFilter('3',3); change_map(3)">Div III</button>
    <button onclick="MyFilter('4',3); change_map(4)">Div IV</button>
    <button onclick="MyFilter('5',3); change_map(5)">Div V</button>
    <button onclick="MyFilter('6',3); change_map(6)">Div VI</button>
    <button onclick="MyFilter('7',3); change_map(7)">Div VII</button>
    <button onclick="MyFilter('',3); change_map(8)">All Div</button>
  </div>
  <br>
  <div>
    <div id="ask-button">
      <button onclick="user_loc()">Use my location to find nearby teams</button>
    </div>
    <div id="post-perm" style='display:none;'>
      <button onclick="q_sort(22)">Sort By Distance</button>
      <button onclick="MyFilter2(10,22);">Within 10mi</button>
      <button onclick="MyFilter2(25,22);">Within 25mi</button>
      <button onclick="MyFilter2(50,22);">Within 50mi</button>
    </div>
  </div>
  <br>
<select id="year_dd" onchange="new_rankings('false')" style="font-size: 25px;">
	<option value=2018 selected="selected">2018</option>
	<option value=2017>2017</option>
	<option value=2016>2016</option>
	<option value=2015>2015</option>
	<option value=2014>2014</option>
	<option value=2013>2013</option>
	<option value=2012>2012</option>
	<option value=2011>2011</option>
	<option value=2010>2010</option>
	<option value=2009>2009</option>
	<option value=2008>2008</option>
</select>
<div id="week-pick" onclick="new_rankings('true')">
  <button class="btn active">0</button>
  <button class="btn">1</button>
  <button class="btn">2</button>
  <button class="btn">3</button>
  <button class="btn">4</button>
  <button class="btn">5</button>
  <button class="btn">6</button>
  <button class="btn">7</button>
  <button class="btn">8</button>
  <button class="btn">9</button>
  <button class="btn">10</button>
  <button class="btn">11</button>
  <button class="btn">12</button>
  <button class="btn">13</button>
  <button class="btn">14</button>
  <button class="btn">15</button>
 </div>
  <br>
<div id="test"></div>
<h1 id="tbl-heading"><h1>
<div id="rank-tbl" class="rank-tbl"></div>
<script>
change_map(8);
var curr_week = 1;
new_rankings('false');


  function new_rankings(pres_rank) {
	var yr = document.getElementById("year_dd").value;
	if (yr <= 2010) {
		var url = "https://sites.google.com/site/swaermodel/RankList_2007-10.json?revision=4";
	} else if (yr <= 2014) {
		var url = "https://sites.google.com/site/swaermodel/RankList_2011-14.json?revision=4";
	} else {
		var url = "https://sites.google.com/site/swaermodel/RankList_2015-17.json?revision=4";
	}
	var wk = document.getElementsByClassName("btn active")[0].innerHTML;
	if (yr == 2018) {wk = Number(curr_week)-1;}
	
	bring_ranks(url,yr,wk,pres_rank);
	document.getElementById("tbl-heading").innerText = 'Week ' + wk + ' of ' + yr;
	
	var all_wk = document.getElementsByClassName("btn");
	for (i = curr_week; i < all_wk.length; i++) {
	      if (yr == 2018) {
	      all_wk[i].style.display = "none";
     	      } else if (yr != 2018) {
	      all_wk[i].style.display = "";
	      }
  	}
  };

  function bring_ranks(url,yr,wk,pres_rank) {
    var params = {};  
    params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
    bring_tm_info();
    gadgets.io.makeRequest(url, function(obj) {response(obj,wk,yr,pres_rank);}, params);
  };

  function bring_tm_info() {
    var url = 'https://sites.google.com/site/swaermodel/Tm_Info.json?revision=3'
    var params = {};  
    params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
    gadgets.io.makeRequest(url, quick_resp, params);
  };
  
  function quick_resp(obj) {
	tm_info = obj.data;
  };

  function response(obj,wk_sel,yr_sel,pres_rank) {
    	               
    var yr = yr_sel;
    var wk = wk_sel;
    var responseText = obj.data;
    var row_ord = [];
    var row_hide = [];
    if (pres_rank==='true') {
	row_ord = Row_Order();
	row_hide = Row_Hidden();
    }

	var html = "<table id='rank' onclick='sortColumn(event)'>";
	html += "<thead><tr>";
	html += '<td type="Number" class="fixed freeze">#</td>';
	html += '<td class="fixed freeze">School</td>';
	html += "<td>Rec</td><td type='Number'>Div</td><td type='Number'>Div Rank</td>";
	html += "<td type='Number'>SWAER</td><td type='Number'>iSWAER</td>";
	html += "<td type='Number'>Proj Seed</td><td type='Number'>Curr Seed</td>"
	html += "<td type='Number'>Playoffs</td><td type='Number'>State Champ</td>";
	html += "<td type='Number'>Conf Champ</td>";
	html += "<td>Conference</td><td>Conf W-L</td><td>Conf Main</td>";
	html += "<td type='Number'>Change in "+ yr +"</td><td>County</td><td>Region</td>";
	html += "<td>Lon</td><td>Lat</td><td>Tm_ID</td><td>ConfFull</td>";

	html += "</tr></thead><tbody>";

	for (var k in responseText[yr][wk].Tm_ID) {
		var tm = responseText[yr][wk];
		if (pres_rank==='true') {
			var i = tm.Tm_ID.indexOf(Number(row_ord[k]));
		} else {
			var i = tm.OvrRank.indexOf(Number(k)+1);
		}
		//html += '<tr><td colspan=22>' + tm.Team[i] + '</td></tr>';
		html += '<tr class="tr_shaded" style="display:' + row_hide[k] + ';">';
		html += '<td class="fixed freeze_horizontal">' + tm.OvrRank[i] + '</td>';
		html += '<td class="fixed freeze_horizontal">';
		html += "<img height=25 src='" + tm_info[tm.Team[i]][0]['Helm.Left'] + "'> ";
		html += "<a href=https://sites.google.com/site/swaermodel/teams/" + tm.Team[i] + ">" + tm_info[tm.Team[i]][0]['Best.Name'] + "</a>";
		html += '<sup>D' + tm.Div[i] + '</sup><sub>#' + tm.DivRank[i] + '</sub></td>';
		html += '<td>' + tm.Total[i] + '</td>';
		html += '<td>' + tm.Div[i] + '</td>';
		html += '<td>' + tm.DivRank[i] + '</td>';
		html += '<td>' + tm.SWAER[i] + '</td>';
		html += '<td>' + tm.iSWAER[i] + '</td>';
		html += '<td>' + tm.SeedProj[i] + '</td>';
		html += '<td>' + tm.SeedCurr[i] + '</td>';
		html += '<td>' + tm.Playoffs[i] + '</td>';
		html += '<td>' + tm.State[i] + '</td>';
		html += '<td>' + tm.ConfChamp[i] + '</td>';
		html += '<td><a href="javascript:{}"  target="_top" onclick="MyFilter(\'' + tm.ConfMain[i] + '\',14)">' + tm.ConfMain[i] + '</a>';
		if (tm.ConfSub[i] != null) {
			html += '- <a href="javascript:{}"  target="_top" onclick="MyFilter(\'' + tm.ConfMain[i] + ' - ' + tm.ConfSub[i] + '\',21)">' + tm.ConfSub[i] + '</a>';
		}
		html += '</td><td>' + tm.ConfR[i] + '</td>';
		html += '<td>' + tm.ConfMain[i] + '</td>';
		html += '<td>' + tm.Change[i] + '</td>';
		html += '<td>' + tm.County[i] + '</td>';
		html += '<td>' + tm.Reg[i] + '</td>';
		html += '<td>' + tm.Lon[i] + '</td>';
		html += '<td>' + tm.Lat[i] + '</td>';
		html += '<td>' + tm.Tm_ID[i] + '</td>';
		html += '<td>' + tm.ConfMain[i] + ' - ' + tm.ConfSub[i] + '</td>';
		html += '</tr>';
	}	
	html += '</tbody></table>';	
	document.getElementById('rank-tbl').innerHTML = html;
	gadgets.window.adjustHeight();
  };


  function shape_map(div,yr) {
    var url = 'https://sites.google.com/site/swaermodel/map%20shapes.json?revision=3'
    var params = {};  
    params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
    gadgets.io.makeRequest(url, function(obj) {shape_resp(obj,div,yr);}, params);
  };



  function shape_resp(obj,div_sel,yr_sel) {
    	               
	var responseText = obj.data;
	var html = '<svg height="500" width="500">'

	for (var j in responseText[yr_sel][div_sel]) {
		html += '<polygon points= "' + responseText[yr_sel][div_sel][j].shp + '" style="fill:red;position:absolute;fill-rule:nonzero;" fill-opacity="0.5" onclick="MyFilter(\'' + j + '\',17)" />'
		html += '<text x="' + responseText[yr_sel][div_sel][j].center_x + '" y="' + responseText[yr_sel][div_sel][j].center_y + '" style="fill:white;font-size:30px;">' + j +'</text>'
	}
	html += '</svg>';

	document.getElementById('region').innerHTML = html;
  };




// Get the container element
var btnContainer = document.getElementById("week-pick");

// Get all buttons with class="btn" inside the container
var btns = btnContainer.getElementsByClassName("btn");

// Loop through the buttons and add the active class to the current/clicked button
for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener("click", function() {
    var current = document.getElementsByClassName("btn active");
    current[0].className = current[0].className.replace(" active", "");
    this.className += " active";
  });
}




function Row_Order() {
  // Declare variables 
  var table, tr, td, i, j;
  table = document.getElementById("rank");
  tr = table.getElementsByTagName("tr");
  var ord_arr = [];
  
  for (i = 1; i < tr.length; i++) {
	ord_arr.push(tr[i].getElementsByTagName("td")[20].innerHTML);
  }
return(ord_arr);
}


function Row_Hidden() {
  // Declare variables 
  var table, tr, td, i, j;
  table = document.getElementById("rank");
  tr = table.getElementsByTagName("tr");
  var ord_arr = [];
  
  for (i = 1; i < tr.length; i++) {
	ord_arr.push(tr[i].style.display);
  }
return(ord_arr);
}



function MyFilter(on,col) {
  // Declare variables 
  var table, tr, td, i, j;
  table = document.getElementById("rank");
  tr = table.getElementsByTagName("tr");
  j=1;
  
  // Loop through all table rows, and hide those who don't match the search query
  for (i = 1; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[col];
    if (td) {
      if (td.innerHTML === on | on==="") {
        tr[i].style.display = "";
        } else {
        tr[i].style.display = "none";
      } 
     }
  }
gadgets.window.adjustHeight();}


function MyFilter2(on,col) {
  // Declare variables 
  var table, tr, td, i;
  table = document.getElementById("rank");
  tr = table.getElementsByTagName("tr");
  
  // Loop through all table rows, and hide those who don't match the search query
  for (i = 1; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[col];
    if (td) {
      if (td.innerHTML <= on) {
        tr[i].style.display = "";
        } else {
        tr[i].style.display = "none";
      } 
     }
  }
gadgets.window.adjustHeight();}


function change_map(keep) {
var yr = document.getElementById("year_dd").value;

if (keep === 8) {
	document.getElementById("county").style.display = "";
	document.getElementById("region").style.display = "none";
} else {
	document.getElementById("county").style.display = "none";
	shape_map(Number(keep),yr);
	document.getElementById("region").style.display = "";
}
}

function user_loc() {
  var startPos;
  var geoSuccess = function(position) {
    startPos = position;
    var tr = document.getElementById("rank").getElementsByTagName("tr");
    var user_lat = startPos.coords.latitude;
    var user_lon = startPos.coords.longitude;
    var lon = "";
    var lat = "";
    var dist = "";
    var output = "";
    for (i = 1; i < tr.length; i++) {
    lon = tr[i].getElementsByTagName("td")[18].innerHTML;
    lat = tr[i].getElementsByTagName("td")[19].innerHTML;
    var new_el = document.createElement("td");
    tr[i].appendChild(new_el);
    dist = Math.pow((Math.pow((user_lat-lat)*69, 2) + Math.pow((user_lon-lon)*52, 2)),0.5);
    tr[i].getElementsByTagName("td")[22].innerHTML = dist;
    //if (dist <= 15) {
    //output += '<li>' + tr[i].getElementsByTagName("td")[1].innerHTML + '</li>';
    //}
    }
    //document.getElementById('nearby').innerHTML = output;
    document.getElementById("ask-button").style.display = "none";
    document.getElementById("post-perm").style.display = "";
  };
  navigator.geolocation.getCurrentPosition(geoSuccess);
};


function q_sort(colu) {
var table_it = document.getElementById("rank");
sortTable(table_it,colu,1,"Number");
}


var dom = (document.getElementsByTagName) ? true : false;
var ie5 = (document.getElementsByTagName && document.all) ? true : false;
var arrowUp, arrowDown;

if (ie5 || dom)
	initSortTable();

function initSortTable() {
	arrowUp = document.createElement("SPAN");
	//var tn = document.createTextNode("5");
	//arrowUp.appendChild(tn);
	//arrowUp.className = "arrow";

	arrowDown = document.createElement("SPAN");
	//var tn = document.createTextNode("6");
	//arrowDown.appendChild(tn);
	//arrowDown.className = "arrow";
}



function sortTable(tableNode, nCol, bDesc, sType) {
	var tBody = tableNode.tBodies[0];
	var trs = tBody.rows;
	var trl= trs.length;
	var a = new Array();
	
	for (var i = 0; i < trl; i++) {
		a[i] = trs[i];
	}
	
	var start = new Date;
	window.status = "Sorting data...";
	a.sort(compareByColumn(nCol,bDesc,sType));
	window.status = "Sorting data done";
	
	for (var i = 0; i < trl; i++) {
		tBody.appendChild(a[i]);
		window.status = "Updating row " + (i + 1) + " of " + trl +
						" (Time spent: " + (new Date - start) + "ms)";
	}
	
	// check for onsort
	if (typeof tableNode.onsort == "string")
		tableNode.onsort = new Function("", tableNode.onsort);
	if (typeof tableNode.onsort == "function")
		tableNode.onsort();
}

function CaseInsensitiveString(s) {
	return String(s).toUpperCase();
}

function parseDate(s) {
	return Date.parse(s.replace(/\-/g, '/'));
}

/* alternative to number function
 * This one is slower but can handle non numerical characters in
 * the string allow strings like the follow (as well as a lot more)
 * to be used:
 *    "1,000,000"
 *    "1 000 000"
 *    "100cm"
 */

function toNumber(s) {
    return Number(s.replace(/[^0-9\.]/g, ""));
}

function compareByColumn(nCol, bDescending, sType) {
	var c = nCol;
	var d = bDescending;
	
	var fTypeCast = String;
	
	if (sType == "Number")
	if (nCol == 9 || nCol == 10 || nCol == 11) {
		fTypeCast = toNumber;
	} else {
		fTypeCast = Number;
	}
	else if (sType == "Date")
		fTypeCast = parseDate;
	else if (sType == "CaseInsensitiveString")
		fTypeCast = CaseInsensitiveString;

	return function (n1, n2) {
		if (fTypeCast(getInnerText(n1.cells[c])) < fTypeCast(getInnerText(n2.cells[c])))
			return d ? -1 : +1;
		if (fTypeCast(getInnerText(n1.cells[c])) > fTypeCast(getInnerText(n2.cells[c])))
			return d ? +1 : -1;
		return 0;
	};
}

function sortColumnWithHold(e) {
	// find table element
	var el = ie5 ? e.srcElement : e.target;
	var table = getParent(el, "TABLE");
	
	// backup old cursor and onclick
	var oldCursor = table.style.cursor;
	var oldClick = table.onclick;
	
	// change cursor and onclick	
	table.style.cursor = "wait";
	table.onclick = null;
	
	// the event object is destroyed after this thread but we only need
	// the srcElement and/or the target
	var fakeEvent = {srcElement : e.srcElement, target : e.target};
	
	// call sortColumn in a new thread to allow the ui thread to be updated
	// with the cursor/onclick
	window.setTimeout(function () {
		sortColumn(fakeEvent);
		// once done resore cursor and onclick
		table.style.cursor = oldCursor;
		table.onclick = oldClick;
	}, 100);
}

function sortColumn(e) {
	var tmp = e.target ? e.target : e.srcElement;
	var tHeadParent = getParent(tmp, "THEAD");
	var el = getParent(tmp, "TD");

	if (tHeadParent == null)
		return;
		
	if (el != null) {
		var p = el.parentNode;
		var i;

		// get the index of the td
		var cells = p.cells;
		var l = cells.length;
		for (i = 0; i < l; i++) {
			if (cells[i] == el) break;
		}

		var table = getParent(el, "TABLE");
		// can't fail

		// typecast to Boolean
		// aj added descending as default
		if (el._descending == null & (i==5 || i==6 || i==9 || i==10 || i==11 || i==19)) {
			el._descending = Boolean(el._descending);
		} else {
			el._descending = !Boolean(el._descending);
		}

		if (tHeadParent.arrow != null) {
			if (tHeadParent.arrow.parentNode != el) {
				tHeadParent.arrow.parentNode._descending = null;	//reset sort order		
			}
			tHeadParent.arrow.parentNode.removeChild(tHeadParent.arrow);
		}

		if (el._descending)
			tHeadParent.arrow = arrowUp.cloneNode(true);
		else
			tHeadParent.arrow = arrowDown.cloneNode(true);

		el.appendChild(tHeadParent.arrow);

		
		sortTable(table,i,el._descending, el.getAttribute("type"));
	}
}


function getInnerText(el) {
	if (ie5) return el.innerText;	//Not needed but it is faster
	
	var str = "";
	
	var cs = el.childNodes;
	var l = cs.length;
	for (var i = 0; i < l; i++) {
		switch (cs[i].nodeType) {
			case 1: //ELEMENT_NODE
				str += getInnerText(cs[i]);
				break;
			case 3:	//TEXT_NODE
				str += cs[i].nodeValue;
				break;
		}
		
	}
	
	return str;
}

function getParent(el, pTagName) {
	if (el == null) return null;
	else if (el.nodeType == 1 && el.tagName.toLowerCase() == pTagName.toLowerCase())	// Gecko bug, supposed to be uppercase
		return el;
	else
		return getParent(el.parentNode, pTagName);
}



//start freeze panes


function freeze_pane_listener(what_is_this, table_class) {
  // Wrapping a function so that the listener can be defined
  // in a loop over a set of scrolling table id's.
  // Cf. http://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example
  
  return function() {
    var i;
    var translate_y = "translate(0," + what_is_this.scrollTop + "px)";
    var translate_x = "translate(" + what_is_this.scrollLeft + "px,0px)";
    var translate_xy = "translate(" + what_is_this.scrollLeft + "px," + what_is_this.scrollTop + "px)";
    
    var fixed_vertical_elts = document.getElementsByClassName(table_class + " freeze_vertical");
    var fixed_horizontal_elts = document.getElementsByClassName("freeze_horizontal");
    var fixed_both_elts = document.getElementsByClassName("freeze");
    
    // The webkitTransforms are for a set of ancient smartphones/browsers,
    // one of which I have, so I code it for myself:
    for (i = 0; i < fixed_horizontal_elts.length; i++) {
      fixed_horizontal_elts[i].style.webkitTransform = translate_x;
      fixed_horizontal_elts[i].style.transform = translate_x;
    }

    for (i = 0; i < fixed_vertical_elts.length; i++) {
       fixed_vertical_elts[i].style.webkitTransform = translate_y;
       fixed_vertical_elts[i].style.transform = translate_y;
    }

    for (i = 0; i < fixed_both_elts.length; i++) {
       fixed_both_elts[i].style.webkitTransform = translate_xy;
       fixed_both_elts[i].style.transform = translate_xy;
    }
  }
}

function even_odd_color(i) {
  if (i % 2 == 0) {
    return "#e0e0e0";
  } else {
    return "#ffffff";
  }
}

function parent_id(wanted_node_name, elt) {
  // Function to work up the DOM until it reaches
  // an element of type wanted_node_name, and return
  // that element's id.
  
  var wanted_parent = parent_elt(wanted_node_name, elt);
  
  if ((wanted_parent == undefined) || (wanted_parent.nodeName == null)) {
    // Sad trombone noise.
    return "";
  } else {
    return wanted_parent.id;
  }
}

function parent_elt(wanted_node_name, elt) {
  // Function to work up the DOM until it reaches 
  // an element of type wanted_node_name, and return
  // that element.
  
  var this_parent = elt.parentElement;
  if ((this_parent == undefined) || (this_parent.nodeName == null)) {
    // Sad trombone noise.
    return null;
  } else if (this_parent.nodeName == wanted_node_name) {
    // Found it:
    return this_parent;
  } else {
    // Recurse:
    return parent_elt(wanted_node_name, this_parent);
  }
}

var i, parent_div_id, parent_tr, table_i, scroll_div;
var scrolling_table_div_ids = ["rank-tbl"];

// This array will let us keep track of even/odd rows:
var scrolling_table_tr_counters = [];
for (i = 0; i < scrolling_table_div_ids.length; i++) {
  scrolling_table_tr_counters.push(0);
}

// Append the parent div id to the class of each frozen element:
var fixed_elements = document.getElementsByClassName("fixed");
for (i = 0; i < fixed_elements.length; i++) {
  fixed_elements[i].className += " " + parent_id("DIV", fixed_elements[i]);
}

// Set background colours of row headers, alternating according to 
// even_odd_color(), which should have the same values as those
// defined in the CSS for the tr_shaded class.
var fixed_horizontal_elements = document.getElementsByClassName("freeze_horizontal");
for (i = 0; i < fixed_horizontal_elements.length; i++) {
  parent_div_id = parent_id("DIV", fixed_horizontal_elements[i]);
  table_i = scrolling_table_div_ids.indexOf(parent_div_id);
  
  if (table_i >= 0) {
    parent_tr = parent_elt("TR", fixed_horizontal_elements[i]);
    
    if (parent_tr.className.match("tr_shaded")) {
      fixed_horizontal_elements[i].style.backgroundColor = even_odd_color(scrolling_table_tr_counters[table_i]);
      scrolling_table_tr_counters[table_i]++;
    }
  }
}



// Add event listeners.
for (i = 0; i < scrolling_table_div_ids.length; i++) {
  scroll_div = document.getElementById(scrolling_table_div_ids[i]);
  scroll_div.addEventListener("scroll", freeze_pane_listener(scroll_div, scrolling_table_div_ids[i]));
}











</script>

<style>

       

table			{border-top: 1px solid grey;
			 border-left: 1px solid buttonshadow;
			 border-right: 1px solid buttonhighlight;
			 border-bottom: 1px solid grey;
			 border-collapse: separate;
			 white-space: nowrap;}

  
td 			{color: windowtext; font: menu; padding: 1px; padding-left: 5px; padding-right: 5px; text-align:center; font-size: 2.5vw;
			border-bottom: 1.5px solid grey;
			background-color: white;
			}


thead td	{background: buttonface; font: menu; border: 1px outset white;
			 cursor: default; padding-top: 0; padding: bottom: 0;
			 border-top: 1px solid buttonhighlight;
			 border-left: 1px solid buttonhighlight;
			 border-right: 1px solid buttonshadow;
			 border-bottom: 1px solid buttonshadow;
			 height: 16px; font-size: 3vw; white-space: normal;
			 }

thead .arrow		{font-family: webdings; color: black; padding: 0; font-size: 10px;
			height: 11px; width: 10px; overflow: hidden;
			margin-bottom: 2; margin-top: -3; padding: 0; padding-top: 0; padding-bottom: 2;}
			/*nice vertical positioning :-) */



#rank-tbl {
  margin: 2vw;
  width: 94vw;
  overflow-x: scroll;
  overflow-y: visible;
}

.fixed.freeze_horizontal {
  position: relative;
  text-align: left;
}

td:nth-of-type(5) {
            display: none;
            }
td:nth-of-type(15) {
            display: none;
            }
td:nth-of-type(19) {
            display: none;
            }
td:nth-of-type(20) {
            display: none;
            }
td:nth-of-type(21) {
            display: none;
            }
td:nth-of-type(22) {
            display: none;
            }
td:nth-of-type(23) {
            display: none;
            }

@media screen and (min-width: 850px) {
td 		{font-size: 16px;}
thead td	{font-size: 16px;}
}	

#img-div {
  position:relative; width:500px; height:500px; background-size: contain;
  background-image: url("https://www.worldatlas.com/webimage/countrys/namerica/usstates/counties/ohnames.gif");
  background-repeat: no-repeat;
}

#county a {display:block; position:absolute; width:40px; height:40px;}
    
#county   
a.adams  {left:132px; top:420px;}
a.allen  {left:57px; top:146px;}
a.ashland  {left:267px; top:142px;}
a.ashtabula  {left:438px; top:13px;}
a.athens  {left:298px; top:345px;}
a.auglaize  {left:53px; top:184px;}
a.belmont  {left:416px; top:254px;}
a.brown  {left:88px; top:403px;}
a.butler  {left:7px; top:336px;}
a.carroll  {left:403px; top:175px;}
a.champaign  {left:100px; top:237px;}
a.clark  {left:97px; top:270px;}
a.clermont  {left:55px; top:393px;}
a.clinton  {left:97px; top:341px;}
a.columbiana  {left:435px; top:150px;}
a.coshocton  {left:310px; top:213px;}
a.crawford  {left:195px; top:136px;}
a.cuyahoga  {left:336px; top:51px;}
a.darke  {left:2px; top:238px;}
a.defiance  {left:14px; top:74px;}
a.delaware  {left:187px; top:216px;}
a.erie  {left:230px; top:61px;}
a.fairfield  {left:231px; top:292px;}
a.fayette  {left:135px; top:321px;}
a.franklin  {left:186px; top:261px;}
a.fulton  {left:57px; top:30px;}
a.gallia  {left:262px; top:424px;}
a.geauga  {left:390px; top:39px;}
a.greene  {left:86px; top:299px;}
a.guernsey  {left:359px; top:251px;}
a.hamilton  {left:12px; top:374px;}
a.hancock  {left:112px; top:116px;}
a.hardin  {left:112px; top:163px;}
a.harrison  {left:401px; top:213px;}
a.henry  {left:60px; top:70px;}
a.highland  {left:115px; top:369px;}
a.hocking  {left:248px; top:325px;}
a.holmes  {left:306px; top:178px;}
a.huron  {left:232px; top:94px;}
a.jackson  {left:231px; top:392px;}
a.jefferson  {left:438px; top:203px;}
a.knox  {left:248px; top:198px;}
a.lake  {left:385px; top:15px;}
a.lawrence  {left:238px; top:448px;}
a.licking  {left:246px; top:242px;}
a.logan  {left:99px; top:202px;}
a.lorain  {left:286px; top:75px;}
a.lucas  {left:126px; top:33px;}
a.madison  {left:138px; top:270px;}
a.mahoning  {left:435px; top:113px;}
a.marion  {left:170px; top:177px;}
a.medina  {left:308px; top:96px;}
a.meigs  {left:295px; top:391px;}
a.mercer  {left:1px; top:181px;}
a.miami  {left:47px; top:251px;}
a.monroe  {left:404px; top:297px;}
a.montgomery  {left:42px; top:292px;}
a.morgan  {left:318px; top:311px;}
a.morrow  {left:206px; top:180px;}
a.muskingum  {left:303px; top:261px;}
a.noble  {left:360px; top:288px;}
a.ottawa  {left:178px; top:39px;}
a.paulding  {left:7px; top:99px;}
a.perry  {left:271px; top:293px;}
a.pickaway  {left:187px; top:308px;}
a.pike  {left:178px; top:386px;}
a.portage  {left:390px; top:91px;}
a.preble  {left:-1px; top:292px;}
a.putnam  {left:57px; top:114px;}
a.richland  {left:239px; top:147px;}
a.ross  {left:179px; top:349px;}
a.sandusky  {left:171px; top:62px;}
a.scioto  {left:192px; top:426px;}
a.seneca  {left:171px; top:98px;}
a.shelby  {left:48px; top:210px;}
a.stark  {left:371px; top:141px;}
a.summit  {left:351px; top:96px;}
a.trumbull  {left:439px; top:72px;}
a.tuscarawas  {left:357px; top:193px;}
a.union  {left:145px; top:213px;}
a.van-wert  {left:7px; top:139px;}
a.vinton  {left:242px; top:367px;}
a.warren  {left:54px; top:338px;}
a.washington  {left:363px; top:336px;}
a.wayne  {left:312px; top:139px;}
a.williams  {left:8px; top:35px;}
a.wood  {left:112px; top:60px;}
a.wyandot  {left:151px; top:137px;}

          
#region a {display:block; position:absolute; width:80px; height:80px; background-color: red; text-align: center; font-size: 60px; color: white;}
#region
          a.Reg-1  {left:343px; top:56px;}
          a.Reg-2  {left:186px; top:159px;}
          a.Reg-3  {left:127px; top:257px;}
          a.Reg-4  {left:1px; top:339px;}
          a.Reg-5  {left:351px; top:46px;}
          a.Reg-6  {left:221px; top:35px;}
          a.Reg-7  {left:228px; top:205px;}
          a.Reg-8  {left:39px; top:295px;}
          a.Reg-9  {left:363px; top:68px;}
          a.Reg-10  {left:235px; top:43px;}
          a.Reg-11  {left:229px; top:247px;}
          a.Reg-12  {left:19px; top:276px;}
          a.Reg-13  {left:401px; top:83px;}
          a.Reg-14  {left:182px; top:82px;}
          a.Reg-15  {left:249px; top:262px;}
          a.Reg-16  {left:44px; top:306px;}
          a.Reg-17  {left:367px; top:90px;}
          a.Reg-18  {left:145px; top:88px;}
          a.Reg-19  {left:236px; top:327px;}
          a.Reg-20  {left:27px; top:307px;}
          a.Reg-21  {left:371px; top:71px;}
          a.Reg-22  {left:126px; top:73px;}
          a.Reg-23  {left:262px; top:260px;}
          a.Reg-24  {left:17px; top:234px;}
          a.Reg-25  {left:387px; top:92px;}
          a.Reg-26  {left:102px; top:69px;}
          a.Reg-27  {left:257px; top:290px;}
          a.Reg-28  {left:32px; top:226px;}

#week-pick {
    width: 100vw; /* Width of the outside container */
}

button {
  font-size: 2vw;
}

.btn {
  border: none;
  outline: none;
  padding: 0.1vw;
  width: 5.3vw;
  height: 50px;
  background-color: #f1f1f1;
  cursor: pointer;
  font-size: 2vw;
}

/* Style the active class (and buttons on mouse-over) */
.active, .btn:hover {
  background-color: #666;
  color: white;
}


</style>            

</body>
]]>
</Content>
</Module>